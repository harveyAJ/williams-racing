<?xml version="1.0"?>

<nlog xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xmlns="http://www.nlog-project.org/schemas/NLog.xsd">
    <!-- enable asp.net core layout renderers -->
    <extensions>
        <add assembly="NLog.Web.AspNetCore"/>
    </extensions>
    <targets>
        <target name="console" xsi:type="Console">
            <layout type="JsonLayout">
                <attribute name="time" layout="${longdate:universalTime=true}"/>
                <attribute name="callsite" layout="${callsite}"/>
                <attribute name="level" layout="${level}"/>
                <attribute name="message" layout="${message}"/>
                <attribute name="exception" layout="${exception:maxInnerExceptionLevel=10}"/>
                <attribute name="data" encode="false">
                    <layout type='JsonLayout' includeAllProperties="true" maxRecursionLimit="20"/>
                </attribute>
            </layout>
        </target>
    </targets>

    <rules>
        <logger name="Microsoft.AspNetCore.Hosting.*" maxlevel="Info" final="true"/>
        <logger name="*" minlevel="Info" writeTo="file"/>
        <logger name="*" minlevel="${environment:LOG_LEVEL:whenEmpty=Info}" writeTo="console"/>
    </rules>
</nlog>